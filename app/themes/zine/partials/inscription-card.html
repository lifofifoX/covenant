<a
  class="inscription-card"
  href="/<%= encodeURIComponent(collection.slug) %>/<%= encodeURIComponent(inscription.id) %>"
  data-testid="inscription-card"
  data-inscription-id="<%= inscription.id %>"
>
  <% if (order && order.status === 'pending') { %>
    <span class="pending-badge">
      <span class="button-spinner" style="width: 10px; height: 10px; border-width: 1px;"></span>
      Pending
    </span>
  <% } else if (order && order.status === 'confirmed') { %>
    <span class="sold-badge">Sold</span>
  <% } %>

  <div class="inscription-image" style="<%= (order && (order.status === 'pending' || order.status === 'confirmed')) ? 'opacity: 0.5; filter: grayscale(100%);' : '' %>" data-controller="image">
    <div style="position: absolute; inset: 0; background: linear-gradient(45deg, #e0e0e0, #f0f0f0);" data-image-target="skeleton"></div>
    <% if (order && order.status === 'pending') { %>
      <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.1); z-index: 1;">
        <span class="button-spinner" style="width: 20px; height: 20px; border-width: 2px; color: var(--color-warning);"></span>
      </div>
    <% } %>
    <% if (order && order.status === 'confirmed') { %>
      <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.1); z-index: 1;">
        <span style="font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; color: var(--color-secondary);">Sold</span>
      </div>
    <% } %>
    <% if (inscription.isImage) { %>
      <img
        src="<%= inscription.contentUrl %>"
        alt="<%= inscription.title %>"
        loading="lazy"
        decoding="async"
        style="image-rendering: pixelated"
        class="opacity-0 transition-opacity duration-300"
        data-image-target="img"
        data-action="load->image#loaded error->image#error"
        data-testid="inscription-thumb"
      />
    <% } else { %>
      <iframe
        src="<%= inscription.previewUrl %>"
        class="pointer-events-none opacity-0 transition-opacity duration-300"
        loading="lazy"
        allow="accelerometer; gyroscope"
        data-image-target="media"
        data-action="load->image#loaded error->image#error"
        data-testid="inscription-thumb"
      ></iframe>
    <% } %>
  </div>

  <div class="inscription-id" data-testid="inscription-title">
    <%= inscription.title %>
  </div>
  <div style="font-size: 0.7rem; color: var(--color-muted); margin-top: 2px;">
    #<%= new Intl.NumberFormat('en-US').format(inscription.number) %>
  </div>

  <% if (order && order.status === 'pending') { %>
    <span class="inscription-price" style="background: var(--color-warning-bg); color: var(--color-primary);" data-testid="inscription-price">
      Pending
    </span>
  <% } else if (order && order.status === 'confirmed') { %>
    <span class="inscription-price sold" data-testid="inscription-price">Sold</span>
  <% } else { %>
    <span class="inscription-price" data-testid="inscription-price"><%= formatSats(collection.price_sats) %></span>
  <% } %>
</a>
