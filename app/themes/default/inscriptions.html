<section class="pb-6" data-testid="inscriptions-page">
  <h2 class="sr-only" data-testid="page-title">Store</h2>

  <div>
    <% if (collection.parent_inscription_id || collection.gallery_inscription_id) { %>
      <% const isGallery = Boolean(collection.gallery_inscription_id) %>
      <% const bannerId = isGallery ? collection.gallery_inscription_id : collection.parent_inscription_id %>
      <div class="mb-6 overflow-hidden border border-white/10 bg-base-950/40 shadow-panel backdrop-blur-sm" data-testid="parent-banner">
        <div class="flex items-stretch">
          <a
            class="block w-24 shrink-0 overflow-hidden border-r border-white/10 bg-white/[0.02]"
            href="/<%= encodeURIComponent(collection.slug) %>"
            data-testid="parent-thumb-link"
          >
            <img
              src="https://ordinals.com/content/<%= encodeURIComponent(bannerId) %>"
              alt=""
              loading="lazy"
              decoding="async"
              style="image-rendering: pixelated"
              class="block h-full w-full object-cover"
              data-testid="parent-thumb"
            />
          </a>
          <div class="min-w-0 px-5 py-4" data-testid="parent-meta">
            <div class="flex min-w-0 items-center justify-between gap-4" data-testid="parent-title-row">
              <a
                class="min-w-0 truncate text-[15px] font-semibold tracking-tight text-content hover:text-white"
                href="/<%= encodeURIComponent(collection.slug) %>"
                data-testid="parent-collection-link"
              ><%= collection.title %></a>
              <a
                class="shrink-0 inline-flex items-center gap-2 rounded-md border border-white/10 bg-white/[0.03] px-2 py-1 font-mono text-xs leading-none text-white/75 hover:border-white/20 hover:bg-white/[0.05] hover:text-white"
                href="https://ordinals.com/inscription/<%= encodeURIComponent(bannerId) %>"
                target="_blank"
                rel="noopener"
                data-testid="parent-ordinals-number-link"
              ><span class="leading-none">#<%= parentInscription.number %></span><span class="ord-dot" aria-hidden="true">â—‰</span></a>
            </div>
            <div class="mt-3 flex flex-wrap items-center gap-2 text-xs text-white/60" data-testid="parent-info">
              <% if (isGallery) { %>
                <span class="inline-flex items-center gap-2 rounded-full border border-synth-yellow/35 bg-synth-yellow/10 px-2 py-1 text-synth-yellow" data-testid="parent-children">
                  <span aria-hidden="true">ğŸ–¼ï¸</span>
                  <span class="font-mono text-content"><%= new Intl.NumberFormat('en-US').format(parentInscription.galleryCount) %></span>
                </span>
              <% } else { %>
                <span class="inline-flex items-center gap-2 rounded-full border border-synth-red/35 bg-synth-red/10 px-2 py-1 text-synth-red" data-testid="parent-children" data-tooltip="On-chain parent child provenance" title="On-chain parent child provenance">
                  <span aria-hidden="true">ğŸ§¬</span>
                  <span class="font-mono text-content"><%= new Intl.NumberFormat('en-US').format(parentInscription.childCount) %></span>
                </span>
                <% if (parentInscription.isSealed) { %>
                  <span class="inline-flex items-center gap-2 rounded-full border border-orange-500/30 bg-orange-500/10 px-2 py-1 font-semibold text-orange-400" data-testid="parent-sealed" data-tooltip="The parent inscription owner cannot create more children" title="The parent inscription owner cannot create more children"><span aria-hidden="true">ğŸ”¥</span><span class="uppercase tracking-wide">Sealed</span></span>
                <% } else { %>
                  <span class="inline-flex items-center gap-2 rounded-full border border-emerald-400/25 bg-emerald-400/10 px-2 py-1 font-semibold text-emerald-300" data-testid="parent-unsealed" data-tooltip="The parent inscription owner can create more children" title="The parent inscription owner can create more children"><span aria-hidden="true">ğŸ”“</span><span class="uppercase tracking-wide">Unsealed</span></span>
                <% } %>
              <% } %>
            </div>
          </div>
        </div>
      </div>
    <% } %>
    <% if ((collection.itemsCount ?? 0) === 0) { %>
      <div class="border border-white/10 bg-white/[0.02] px-6 py-10 text-center" data-testid="empty-state">
        <div class="text-sm font-semibold tracking-tight text-content" data-testid="empty-title">No inscriptions available</div>
      </div>
    <% } else { %>
    <div data-testid="grid" class="grid grid-cols-[repeat(auto-fill,minmax(240px,1fr))] gap-4">
        <%- collection.itemsHtml %>
    </div>
    <% } %>

    <% if ((collection.itemsCount ?? 0) > 0 && (pagination.totalPages ?? 1) > 1) { %>
    <div class="mt-8 flex items-center justify-between gap-3" data-testid="pagination">
      <a
        class="inline-flex items-center border border-white/10 bg-white/[0.03] px-4 py-2 text-sm font-semibold tracking-tight text-white/85 hover:border-white/20 hover:bg-white/[0.05] <%= pagination.hasPrev ? '' : 'invisible' %>"
        href="<%= pagination.prevUrl %>"
        data-testid="prev-page"
        data-action="click->store#paginate"
      >Prev</a>
      <div class="flex flex-wrap items-center justify-center gap-2" data-testid="page-links">
        <% if ((pagination.pages ?? []).length > 0) { %>
            <% pagination.pages.forEach((pageLink) => { %>
              <% if (pageLink.type === 'gap') { %>
              <span class="px-2 py-2 text-sm font-semibold text-white/35" aria-hidden="true">â€¦</span>
            <% } else { %>
              <a
                  class="<%= pageLink.isActive ? 'inline-flex min-w-9 items-center justify-center border border-synth-yellow/35 bg-synth-yellow/10 px-3 py-2 text-sm font-semibold tracking-tight text-white/90' : 'inline-flex min-w-9 items-center justify-center border border-white/10 bg-white/[0.02] px-3 py-2 text-sm font-semibold tracking-tight text-white/70 hover:border-white/20 hover:bg-white/[0.04]' %>"
                  href="<%= pageLink.url %>"
                data-testid="page-link"
                  data-page="<%= pageLink.n %>"
                data-action="click->store#paginate"
                ><%= pageLink.n %></a>
            <% } %>
          <% }) %>
        <% } else { %>
            <div class="flex items-center gap-2 border border-white/10 bg-white/[0.03] px-3 py-2 font-mono text-xs text-white/60" data-testid="page-pill">
            <strong class="font-semibold text-white/70">Page</strong>
              <span data-store-target="page"><%= pagination.page %></span>
          </div>
        <% } %>
      </div>
      <a
        class="inline-flex items-center border border-synth-yellow/35 bg-synth-yellow/10 px-4 py-2 text-sm font-semibold tracking-tight text-white/90 hover:bg-synth-yellow/15 <%= pagination.hasNext ? '' : 'invisible' %>"
        href="<%= pagination.nextUrl %>"
        data-testid="next-page"
        data-action="click->store#paginate"
      >Next</a>
    </div>
    <% } %>
  </div>
</section>
