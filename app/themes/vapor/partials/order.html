<div data-testid="order-panel">
  <% const isPending = order.status === 'pending' %>

  <div class="message <%= isPending ? 'message-pending' : 'message-success' %>" data-testid="order-banner">
    <div class="message-title"><%= isPending ? 'Transaction Pending // 処理中' : 'Item Sold // 売却済み' %></div>
  </div>

  <div style="margin-top: 20px;" data-testid="order-details">
    <table class="properties-table">
      <tr>
        <td>Status:</td>
        <td style="<%= isPending ? 'color: #FFD93D;' : 'color: #00FFCC;' %>">
          <% if (isPending) { %>
            <span class="button-spinner" style="width: 12px; height: 12px; border-width: 1px; display: inline-block; vertical-align: middle; margin-right: 8px;"></span>
          <% } %>
          <%= order.status.toUpperCase() %>
        </td>
      </tr>
      <tr>
        <td>Price:</td>
        <td style="color: #FF71CE;"><%= formatSats(order.price_sats) %></td>
      </tr>
      <tr>
        <td>Buyer:</td>
        <td><%= order.buyer_address.substring(0, 16) %>...</td>
      </tr>
      <tr>
        <td>TX:</td>
        <td>
          <a href="https://mempool.space/tx/<%= order.txid %>" target="_blank" rel="noopener"><%= order.txid.substring(0, 16) %>...</a>
        </td>
      </tr>
    </table>
  </div>

  <% const extra = JSON.parse(order.extra_details || '{}') %>
  <% const optionalPayments = extra.optional_payments || [] %>
  <% if (optionalPayments.length > 0) { %>
    <div style="margin-top: 20px;" data-testid="order-optional-payments">
      <div style="color: #00FFCC; font-family: var(--font-display); font-size: 18px; margin-bottom: 10px;">Additional Payments</div>
      <table class="properties-table">
        <% optionalPayments.forEach((p) => { %>
          <tr>
            <td><%= p.title %>:</td>
            <td style="color: #FF71CE;"><%= formatSats(p.amount) %></td>
          </tr>
        <% }) %>
      </table>
    </div>
  <% } %>
</div>
